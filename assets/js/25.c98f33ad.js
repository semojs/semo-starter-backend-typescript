(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{372:function(s,t,a){"use strict";a.r(t);var e=a(42),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"semo-用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#semo-用法"}},[s._v("#")]),s._v(" Semo 用法")]),s._v(" "),a("p",[s._v("更详细的 Semo 用法可以参考"),a("a",{attrs:{href:"https://semo.js.org",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1),s._v("，这里只做一些简单的说明。")]),s._v(" "),a("h2",{attrs:{id:"在脚本中引用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在脚本中引用"}},[s._v("#")]),s._v(" 在脚本中引用")]),s._v(" "),a("p",[s._v("目前 "),a("code",[s._v("Semo")]),s._v(" 除了做为命令行工具，暴露出的对象只有一个，所以看起来都是下面这样进行引入的：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import { Utils } from '@semo/core'\n")])])]),a("h2",{attrs:{id:"utils里都包含什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#utils里都包含什么"}},[s._v("#")]),s._v(" Utils里都包含什么")]),s._v(" "),a("h3",{attrs:{id:"一些常用npm-包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一些常用npm-包"}},[s._v("#")]),s._v(" 一些常用npm 包")]),s._v(" "),a("p",[s._v("到目前为止，Utils 包含了大量的第三方 npm 包，这些包目前没有分使用场景，都包含进来了，后面会考虑优化，目前考虑的是业务方可以少引入几个包，由于经常维护更新，这里不一定是最新的，可以参考最新 Semo 版本的 package.json 文件。")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" fs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fs-extra'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" glob "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'glob'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" table "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'table'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" findUp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'find-up'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" _ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lodash'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" colorize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'json-colorizer'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" stringify "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'json-stringify-pretty-compact'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" chalk "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'chalk'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" day "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dayjs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" co "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'co'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" shell "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'shelljs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" debug "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'debug'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" inquirer "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'inquirer'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" fuzzy "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fuzzy'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" emoji "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node-emoji'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("h3",{attrs:{id:"一些-semo-自定义的方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一些-semo-自定义的方法"}},[s._v("#")]),s._v(" 一些 Semo 自定义的方法")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("md5 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 简单封装个 md5")]),s._v("\ndelay "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 模拟延迟，单位 ms，别名：sleep")]),s._v("\nsplitComma "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根据空格和逗号切分字符串")]),s._v("\nlog "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出普通的 log")]),s._v("\nwarn "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出警告")]),s._v("\ninfo "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出一般信息")]),s._v("\nsuccess "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出成功信息")]),s._v("\nerror "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出错误信息")]),s._v("\noutputTable "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出表格")]),s._v("\ninvokeHook "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 调用钩子，这个函数比较常用")]),s._v("\nextendSubCommand "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义子命令目录，实现了让其他插件扩展自己的目的，在插件中用的比较多")]),s._v("\ngetAllPluginsMapping "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 返回所有的插件")]),s._v("\ngetCombinedConfig "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 返回合并后的配置")]),s._v("\ngetApplicationConfig "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 返回应用配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 调用其他 shell 命令，和 shelljs.exec 有差异")]),s._v("\n")])])]),a("h3",{attrs:{id:"通过-semo-获取其他插件注入的资源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过-semo-获取其他插件注入的资源"}},[s._v("#")]),s._v(" 通过 Semo 获取其他插件注入的资源")]),s._v(" "),a("p",[s._v("以数据库和缓存插件为例")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// sequelize 封装了对各个数据库的链接，内置支持 postgres,mysql, sqlite\n// redis 封装了 Redis\nconst { sequelize, redis } = await Utils.invoke('components)\n")])])]),a("p",[s._v("使用同样的方式可以继续封装的更多")]),s._v(" "),a("p",[s._v("由于连接都是基于 Consul 的，而 Consul 是分本地和线上环境的，所以基本上可以说自然获得了环境隔离的能力。")]),s._v(" "),a("h2",{attrs:{id:"当做命令行工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#当做命令行工具"}},[s._v("#")]),s._v(" 当做命令行工具")]),s._v(" "),a("p",[s._v("Semo 和 Semo 的插件以及整合了 Semo 的项目都会定义大量的命令，具体可以查看帮助：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("semo help\nsemo --help\nsemo -h\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("这里的命令是多层级的，如果发现你可能想要用的子命令，还需要继续用 help 查看里面是否还有子命令，或者查看命令是否有其他选项可用，例如：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("semo generate help\n")])])])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("有些命令我们经常执行，为了少敲几个字符，建议建立别名，配置到 "),a("code",[s._v(".bashrc")]),s._v(" 或者 "),a("code",[s._v(".zshrc")]),s._v(" 文件里，一般常用的别名如下：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sql")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"semo sequelize"')]),s._v("\n")])])])]),s._v(" "),a("h2",{attrs:{id:"定义自己的命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定义自己的命令"}},[s._v("#")]),s._v(" 定义自己的命令")]),s._v(" "),a("p",[s._v("当你有需要重复执行的脚本需求，就要考虑是否需要封装成一个命令，具体方式可以参看 Semo 文档以及本文档的命令管理小节，也可以参看其他插件的源码。")]),s._v(" "),a("h2",{attrs:{id:"使用-repl-模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-repl-模式"}},[s._v("#")]),s._v(" 使用 REPL 模式")]),s._v(" "),a("p",[s._v("REPL 模式可以帮助我们快速访问一些方法，验证 js 逻辑，是高效开发的一个辅助开发工具。进入 REPL 模式：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("semo repl\n")])])]),a("p",[s._v("默认里面只有一个 Semo 的 Utils 对象，加入 "),a("code",[s._v("--hook")]),s._v(" 参数可以加载项目和插件注入的资源和方法。更多使用 REPL 的技巧可以查看 REPL 小节。")])])}),[],!1,null,null,null);t.default=n.exports}}]);